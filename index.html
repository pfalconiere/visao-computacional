<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document Classifier - With Feedback</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <script src="https://cdn.jsdelivr.net/npm/tiff.js@latest/tiff.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'SF Pro Text', 'Helvetica Neue', Helvetica, Arial, sans-serif;
            background: #fbfbfd;
            color: #1d1d1f;
            line-height: 1.47059;
            font-weight: 400;
            letter-spacing: -0.022em;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        header {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: saturate(180%) blur(20px);
            border-bottom: 1px solid rgba(0, 0, 0, 0.08);
            padding: 12px 0;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 22px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 21px;
            font-weight: 600;
            letter-spacing: -0.021em;
            color: #1d1d1f;
        }

        .lang-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            background: rgba(0, 0, 0, 0.04);
            border-radius: 980px;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .lang-toggle:hover {
            background: rgba(0, 0, 0, 0.08);
        }

        .lang-toggle span {
            font-size: 13px;
            color: #6e6e73;
            font-weight: 500;
        }

        .lang-toggle .active {
            color: #0071e3;
        }

        main {
            flex: 1;
            max-width: 1200px;
            margin: 0 auto;
            padding: 80px 22px 100px;
            width: 100%;
        }

        .hero {
            text-align: center;
            margin-bottom: 60px;
        }

        .hero h1 {
            font-size: 56px;
            line-height: 1.07143;
            font-weight: 600;
            letter-spacing: -0.005em;
            margin-bottom: 6px;
        }

        .hero p {
            font-size: 21px;
            line-height: 1.381;
            font-weight: 400;
            letter-spacing: 0.011em;
            color: #6e6e73;
        }

        .upload-section {
            background: white;
            border-radius: 18px;
            padding: 48px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
            margin-bottom: 40px;
        }

        .upload-area {
            border: 2px dashed #d2d2d7;
            border-radius: 12px;
            padding: 60px 20px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            background: #fbfbfd;
        }

        .upload-area:hover {
            border-color: #0071e3;
            background: #f5f5f7;
        }

        .upload-area.dragover {
            border-color: #0071e3;
            background: #e8f4fd;
        }

        .upload-icon {
            font-size: 48px;
            margin-bottom: 20px;
        }

        .upload-text {
            font-size: 17px;
            color: #6e6e73;
            margin-bottom: 12px;
        }

        .upload-button {
            display: inline-block;
            background: #0071e3;
            color: white;
            padding: 12px 24px;
            border-radius: 980px;
            font-size: 17px;
            font-weight: 400;
            cursor: pointer;
            border: none;
            transition: background 0.2s ease;
        }

        .upload-button:hover {
            background: #0077ed;
        }

        .file-input {
            display: none;
        }

        .preview-section {
            display: none;
            background: white;
            border-radius: 18px;
            padding: 48px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
            margin-bottom: 40px;
        }

        .preview-section.show {
            display: block;
        }

        .preview-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 24px;
            text-align: center;
        }

        .preview-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 24px;
        }

        .preview-image-container {
            width: 100%;
            max-width: 600px;
            background: #f5f5f7;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        .preview-image {
            width: 100%;
            height: auto;
            display: block;
        }

        .file-info {
            text-align: center;
            margin-top: 12px;
        }

        .file-name {
            font-size: 15px;
            color: #6e6e73;
            margin-bottom: 4px;
        }

        .file-size {
            font-size: 13px;
            color: #86868b;
        }

        .classify-button {
            background: #0071e3;
            color: white;
            padding: 14px 32px;
            border-radius: 980px;
            font-size: 17px;
            font-weight: 400;
            border: none;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .classify-button:hover {
            background: #0077ed;
        }

        .classify-button:disabled {
            background: #d2d2d7;
            cursor: not-allowed;
        }

        .result-section {
            display: none;
            background: white;
            border-radius: 18px;
            padding: 48px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
        }

        .result-section.show {
            display: block;
        }

        .result-layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin-bottom: 32px;
            align-items: start;
        }

        .result-preview {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .result-preview-title {
            font-size: 17px;
            font-weight: 600;
            color: #1d1d1f;
        }

        .result-preview-image {
            width: 100%;
            background: #f5f5f7;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        .result-preview-image img {
            width: 100%;
            height: auto;
            display: block;
        }

        .result-preview-info {
            text-align: center;
            padding: 8px 0;
        }

        .result-preview-info .file-name {
            font-size: 13px;
            color: #6e6e73;
            margin-bottom: 2px;
        }

        .result-preview-info .file-size {
            font-size: 12px;
            color: #86868b;
        }

        .result-classification {
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .result-type {
            text-align: center;
            margin-bottom: 24px;
            padding: 0 0 24px 0;
            background: transparent;
            border-bottom: 1px solid #e5e5e7;
        }

        .result-icon {
            font-size: 64px;
            margin-bottom: 12px;
        }

        .result-label {
            font-size: 28px;
            font-weight: 600;
            color: #1d1d1f;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }

        .feature-card {
            background: #f5f5f7;
            padding: 16px;
            border-radius: 12px;
        }

        .feature-name {
            font-size: 11px;
            color: #6e6e73;
            margin-bottom: 4px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .feature-value {
            font-size: 20px;
            font-weight: 600;
            color: #1d1d1f;
        }

        .explanation-text {
            background: transparent;
            padding: 0;
            font-size: 15px;
            line-height: 1.6;
            color: #1d1d1f;
            margin-bottom: 16px;
            text-align: left;
        }

        .paragraph-count {
            background: transparent;
            padding: 0;
            margin-top: 12px;
            font-size: 15px;
            color: #1d1d1f;
            text-align: left;
        }

        .paragraph-count strong {
            font-weight: 600;
        }

        /* Feedback Section */
        .feedback-section {
            background: transparent;
            padding: 24px 0;
            margin-top: 32px;
            border-top: 1px solid #e5e5e7;
        }

        .feedback-title {
            font-size: 17px;
            font-weight: 600;
            text-align: center;
            margin-bottom: 16px;
            color: #1d1d1f;
        }

        .feedback-buttons {
            display: flex;
            gap: 12px;
            justify-content: center;
        }

        .feedback-btn {
            flex: 1;
            padding: 12px 24px;
            border-radius: 980px;
            font-size: 15px;
            font-weight: 500;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .feedback-btn-correct {
            background: #34c759;
            color: white;
        }

        .feedback-btn-correct:hover {
            background: #2fb350;
        }

        .feedback-btn-incorrect {
            background: #ff3b30;
            color: white;
        }

        .feedback-btn-incorrect:hover {
            background: #e6352a;
        }

        .feedback-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .feedback-success {
            text-align: center;
            color: #34c759;
            font-size: 15px;
            font-weight: 500;
            padding: 12px;
        }

        .new-classification {
            text-align: center;
        }

        .new-button {
            background: transparent;
            color: #0071e3;
            padding: 12px 24px;
            border-radius: 980px;
            font-size: 17px;
            border: 2px solid #0071e3;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .new-button:hover {
            background: #0071e3;
            color: white;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .loading.show {
            display: block;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #0071e3;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error {
            display: none;
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            color: #856404;
        }

        .error.show {
            display: block;
        }

        .converting {
            text-align: center;
            padding: 20px;
            color: #6e6e73;
            font-size: 15px;
        }

        @media (max-width: 768px) {
            .hero h1 {
                font-size: 40px;
            }

            .hero p {
                font-size: 17px;
            }

            .upload-section,
            .preview-section,
            .result-section {
                padding: 24px;
            }

            .result-layout {
                grid-template-columns: 1fr;
                gap: 24px;
            }

            .features-grid {
                grid-template-columns: 1fr;
            }

            .feedback-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <div class="logo">Document Classifier</div>
            <div class="lang-toggle" onclick="toggleLanguage()">
                <span id="lang-pt" class="active">PT</span>
                <span>|</span>
                <span id="lang-en">EN</span>
            </div>
        </div>
    </header>

    <main>
        <div class="hero">
            <h1 id="hero-title">Classifique documentos</h1>
            <p id="hero-subtitle">Diferencie advertisements de scientific articles com IA</p>
        </div>

        <div class="error" id="error"></div>

        <div class="upload-section" id="upload-section">
            <div class="upload-area" id="upload-area" onclick="document.getElementById('file-input').click()">
                <div class="upload-icon">📄</div>
                <div class="upload-text" id="upload-text">Arraste uma imagem .tif ou clique para selecionar</div>
                <button class="upload-button" id="upload-button">Escolher arquivo</button>
            </div>
            <input type="file" id="file-input" class="file-input" accept=".tif,.tiff" onchange="handleFileSelect(event)">
        </div>

        <div class="preview-section" id="preview-section">
            <h2 class="preview-title" id="preview-title">Preview</h2>
            <div class="preview-container">
                <div class="converting" id="converting" style="display: none;">Processando imagem...</div>
                <div class="preview-image-container" id="preview-image-container">
                    <img id="preview-image" class="preview-image" alt="Preview">
                </div>
                <div class="file-info">
                    <div class="file-name" id="file-name">document.tif</div>
                    <div class="file-size" id="file-size">0 KB</div>
                </div>
                <button class="classify-button" id="classify-button" onclick="classifyImage()">Classificar documento</button>
            </div>
        </div>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p id="loading-text">Analisando documento...</p>
        </div>

        <div class="result-section" id="result-section">
            <div class="result-layout">
                <div class="result-preview">
                    <h3 class="result-preview-title" id="result-preview-title">Documento analisado</h3>
                    <div class="result-preview-image">
                        <img id="result-preview-img" alt="Document">
                    </div>
                    <div class="result-preview-info">
                        <div class="file-name" id="result-file-name">document.tif</div>
                        <div class="file-size" id="result-file-size">0 KB</div>
                    </div>
                </div>

                <div class="result-classification">
                    <div class="result-type">
                        <div class="result-icon" id="result-icon"></div>
                        <h2 class="result-label" id="result-label">Advertisement</h2>
                    </div>

                    <div class="features-grid" id="features-grid"></div>

                    <!-- FEEDBACK SECTION -->
                    <div class="feedback-section" id="feedback-section">
                        <div class="feedback-title" id="feedback-title">Esta classificação está correta?</div>
                        <div class="feedback-buttons" id="feedback-buttons">
                            <button class="feedback-btn feedback-btn-correct" onclick="sendFeedback(true)">
                                Correto
                            </button>
                            <button class="feedback-btn feedback-btn-incorrect" onclick="sendFeedback(false)">
                                Incorreto
                            </button>
                        </div>
                        <div class="feedback-success" id="feedback-success" style="display: none;"></div>
                    </div>
                </div>
            </div>

            <div class="new-classification">
                <button class="new-button" onclick="resetClassifier()" id="new-button">Nova classificação</button>
            </div>
        </div>
    </main>

    <script>
        let currentLang = 'pt';
        let currentFile = null;
        let currentPreviewUrl = null;
        let currentClassification = null;
        let feedbackSent = false;
        
        const API_URL = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1'
            ? 'http://localhost:5000'
            : 'https://visao-computacional.onrender.com';

        const translations = {
            pt: {
                heroTitle: 'Classifique documentos',
                heroSubtitle: 'Diferencie advertisements de scientific articles com IA',
                uploadText: 'Arraste uma imagem .tif ou clique para selecionar',
                uploadButton: 'Escolher arquivo',
                previewTitle: 'Preview',
                classifyButton: 'Classificar documento',
                loadingText: 'Analisando documento...',
                convertingText: 'Processando imagem...',
                newButton: 'Nova classificação',
                resultPreviewTitle: 'Documento analisado',
                feedbackTitle: 'Esta classificação está correta?',
                feedbackCorrect: 'Correto',
                feedbackIncorrect: 'Incorreto',
                feedbackSuccess: '✓ Obrigado pelo feedback!',
                advertisement: 'Advertisement',
                scientificArticle: 'Artigo Científico',
                paragraphs: 'Parágrafos',
                features: {
                    avg_component_height: 'Altura Média',
                    avg_component_width: 'Largura Média',
                    height_std: 'Desvio Altura',
                    avg_aspect_ratio: 'Aspect Ratio',
                    num_columns_detected: 'Colunas',
                    text_density: 'Densidade',
                    num_text_components: 'Componentes',
                    num_paragraphs: 'Parágrafos',
                    layout_transitions: 'Transições'
                },
                errorTiff: 'Por favor, selecione um arquivo .tif ou .tiff',
                errorClassify: 'Erro ao classificar. Tente novamente.'
            },
            en: {
                heroTitle: 'Classify documents',
                heroSubtitle: 'Differentiate advertisements from scientific articles with AI',
                uploadText: 'Drag a .tif image or click to select',
                uploadButton: 'Choose file',
                previewTitle: 'Preview',
                classifyButton: 'Classify document',
                loadingText: 'Analyzing document...',
                convertingText: 'Processing image...',
                newButton: 'New classification',
                resultPreviewTitle: 'Analyzed document',
                feedbackTitle: 'Is this classification correct?',
                feedbackCorrect: '✓ Correct',
                feedbackIncorrect: '✗ Incorrect',
                feedbackSuccess: '✓ Thanks for your feedback!',
                advertisement: 'Advertisement',
                scientificArticle: 'Scientific Article',
                paragraphs: 'Paragraphs',
                features: {
                    avg_component_height: 'Average Height',
                    avg_component_width: 'Average Width',
                    height_std: 'Height Deviation',
                    avg_aspect_ratio: 'Aspect Ratio',
                    num_columns_detected: 'Columns',
                    text_density: 'Density',
                    num_text_components: 'Components',
                    num_paragraphs: 'Paragraphs',
                    layout_transitions: 'Transitions'
                },
                errorTiff: 'Please select a .tif or .tiff file',
                errorClassify: 'Classification error. Please try again.'
            }
        };

        function toggleLanguage() {
            currentLang = currentLang === 'pt' ? 'en' : 'pt';
            document.getElementById('lang-pt').classList.toggle('active');
            document.getElementById('lang-en').classList.toggle('active');
            updateTexts();
        }

        function updateTexts() {
            const t = translations[currentLang];
            document.getElementById('hero-title').textContent = t.heroTitle;
            document.getElementById('hero-subtitle').textContent = t.heroSubtitle;
            document.getElementById('upload-text').textContent = t.uploadText;
            document.getElementById('upload-button').textContent = t.uploadButton;
            document.getElementById('preview-title').textContent = t.previewTitle;
            document.getElementById('classify-button').textContent = t.classifyButton;
            document.getElementById('loading-text').textContent = t.loadingText;
            document.getElementById('converting').textContent = t.convertingText;
            document.getElementById('new-button').textContent = t.newButton;
            document.getElementById('result-preview-title').textContent = t.resultPreviewTitle;
            document.getElementById('feedback-title').textContent = t.feedbackTitle;
            
            const buttons = document.querySelectorAll('.feedback-btn');
            if (buttons[0]) buttons[0].innerHTML = t.feedbackCorrect;
            if (buttons[1]) buttons[1].innerHTML = t.feedbackIncorrect;
        }

        const uploadArea = document.getElementById('upload-area');
        
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            uploadArea.addEventListener(eventName, preventDefaults, false);
        });

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        ['dragenter', 'dragover'].forEach(eventName => {
            uploadArea.addEventListener(eventName, () => {
                uploadArea.classList.add('dragover');
            }, false);
        });

        ['dragleave', 'drop'].forEach(eventName => {
            uploadArea.addEventListener(eventName, () => {
                uploadArea.classList.remove('dragover');
            }, false);
        });

        uploadArea.addEventListener('drop', handleDrop, false);

        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            if (files.length > 0) {
                handleFile(files[0]);
            }
        }

        function handleFileSelect(e) {
            const files = e.target.files;
            if (files.length > 0) {
                handleFile(files[0]);
            }
        }

        async function handleFile(file) {
            if (!file.name.toLowerCase().endsWith('.tif') && !file.name.toLowerCase().endsWith('.tiff')) {
                showError(translations[currentLang].errorTiff);
                return;
            }

            currentFile = file;
            hideError();

            const fileSize = (file.size / 1024).toFixed(2);
            document.getElementById('file-name').textContent = file.name;
            document.getElementById('file-size').textContent = fileSize + ' KB';
            
            document.getElementById('upload-section').style.display = 'none';
            document.getElementById('preview-section').classList.add('show');
            document.getElementById('converting').style.display = 'block';
            document.getElementById('preview-image-container').style.display = 'none';

            try {
                const arrayBuffer = await file.arrayBuffer();
                const tiff = new Tiff({buffer: arrayBuffer});
                const canvas = tiff.toCanvas();
                
                if (canvas) {
                    const dataUrl = canvas.toDataURL('image/jpeg', 0.9);
                    currentPreviewUrl = dataUrl;
                    document.getElementById('preview-image').src = dataUrl;
                    document.getElementById('preview-image-container').style.display = 'block';
                }
            } catch (error) {
                console.log('Could not convert TIFF:', error);
                const placeholderUrl = 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="600" height="400" viewBox="0 0 600 400"%3E%3Crect width="600" height="400" fill="%23f5f5f7"/%3E%3Ctext x="50%25" y="50%25" font-family="system-ui" font-size="48" fill="%236e6e73" text-anchor="middle" dominant-baseline="middle"%3E🖼️%3C/text%3E%3Ctext x="50%25" y="65%25" font-family="system-ui" font-size="16" fill="%2386868b" text-anchor="middle" dominant-baseline="middle"%3ETIFF Document%3C/text%3E%3C/svg%3E';
                currentPreviewUrl = placeholderUrl;
                document.getElementById('preview-image').src = placeholderUrl;
                document.getElementById('preview-image-container').style.display = 'block';
            } finally {
                document.getElementById('converting').style.display = 'none';
            }
        }

        async function classifyImage() {
            if (!currentFile) return;

            hideError();
            document.getElementById('preview-section').classList.remove('show');
            document.getElementById('loading').classList.add('show');

            const formData = new FormData();
            formData.append('image', currentFile);

            try {
                const response = await fetch(`${API_URL}/classify`, {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();

                if (data.success) {
                    currentClassification = data;
                    feedbackSent = false;
                    displayResult(data);
                } else {
                    throw new Error(data.error || 'Classification failed');
                }
            } catch (error) {
                console.error('Error:', error);
                showError(translations[currentLang].errorClassify);
                document.getElementById('preview-section').classList.add('show');
            } finally {
                document.getElementById('loading').classList.remove('show');
            }
        }

        function displayResult(data) {
            const t = translations[currentLang];
            const isAd = data.classification === 'advertisement';

            document.getElementById('result-preview-img').src = currentPreviewUrl || document.getElementById('preview-image').src;
            document.getElementById('result-file-name').textContent = currentFile.name;
            document.getElementById('result-file-size').textContent = (currentFile.size / 1024).toFixed(2) + ' KB';

            document.getElementById('result-icon').textContent = '';
            document.getElementById('result-label').textContent = isAd ? t.advertisement : t.scientificArticle;

            const featuresGrid = document.getElementById('features-grid');
            featuresGrid.innerHTML = '';

            // Mostrar explicação textual
            if (data.explanation) {
                const explanationDiv = document.createElement('div');
                explanationDiv.className = 'explanation-text';
                explanationDiv.textContent = data.explanation;
                featuresGrid.appendChild(explanationDiv);
            }

            // Mostrar parágrafos apenas para artigos científicos
            if (!isAd && data.num_paragraphs !== undefined) {
                const paragraphDiv = document.createElement('div');
                paragraphDiv.className = 'paragraph-count';
                paragraphDiv.innerHTML = `<strong>${t.paragraphs}:</strong> ${data.num_paragraphs}`;
                featuresGrid.appendChild(paragraphDiv);
            }

            // Reset feedback section
            document.getElementById('feedback-buttons').style.display = 'flex';
            document.getElementById('feedback-success').style.display = 'none';

            
            // Re-enable feedback buttons
            const buttons = document.querySelectorAll('.feedback-btn');
            buttons.forEach(btn => btn.disabled = false);
            document.getElementById('result-section').classList.add('show');
        }

        async function sendFeedback(isCorrect) {
            if (feedbackSent) return;
            
            const t = translations[currentLang];
            const buttons = document.querySelectorAll('.feedback-btn');
            buttons.forEach(btn => btn.disabled = true);

            try {
                const correctClass = isCorrect ? currentClassification.classification : 
                                   (currentClassification.classification === 'advertisement' ? 'scientific_article' : 'advertisement');

                const response = await fetch(`${API_URL}/feedback`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        image_name: currentFile.name,
                        predicted_class: currentClassification.classification,
                        is_correct: isCorrect.toString(),
                        correct_class: correctClass
                    })
                });

                const data = await response.json();

                if (data.success) {
                    feedbackSent = true;
                    document.getElementById('feedback-buttons').style.display = 'none';
                    document.getElementById('feedback-success').textContent = t.feedbackSuccess;
                    document.getElementById('feedback-success').style.display = 'block';
                    console.log(`✓ Feedback enviado! Total: ${data.total_feedbacks}`);
                }
            } catch (error) {
                console.error('Erro ao enviar feedback:', error);
                buttons.forEach(btn => btn.disabled = false);
            }
        }

        function resetClassifier() {
            currentFile = null;
            currentPreviewUrl = null;
            currentClassification = null;
            feedbackSent = false;
            document.getElementById('file-input').value = '';
            document.getElementById('result-section').classList.remove('show');
            document.getElementById('preview-section').classList.remove('show');
            document.getElementById('upload-section').style.display = 'block';
            hideError();
        }

        function showError(message) {
            const errorDiv = document.getElementById('error');
            errorDiv.textContent = message;
            errorDiv.classList.add('show');
        }

        function hideError() {
            document.getElementById('error').classList.remove('show');
        }
    </script>
</body>
</html>
